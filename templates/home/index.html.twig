{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block content %}

<div class="items-center text-center justify-around min-h-screen overflow-auto dark:bg-[#101827]">
    <div>
        <h1 class="text-4xl font-semibold my-2 dark:text-white forest:text-white love:text-loveWhite">{{'welcome'|trans}} {{ app.user.username }}!</h1>
        <h2 class="dark:text-white forest:text-[#F0E1D4] love:text-loveWhite">{{'in_brief'|trans}}</h2>
    </div>
    <div class="flex flex-col align-center w-full justify-center px-6 md:flex-row gap-8">
        <div class="border border-gray-300 h-72 w-full my-4 items-center">
            <div class="bg-darkBlue w-full h-12 flex items-center text-center justify-center forest:bg-[#786759] love:bg-lovePink" >
                <h3 class="text-white font-bold dark:text-white forest:text-white love:text-loveWhite">{{'revenue'|trans}}</h3>
            </div>
            <h5 class="italic text-sm text-gray-600 pt-5 py-2 dark:text-white love:text-loveWhite">{{'global'|trans}}</h5>
            <p class="font-semibold text-5xl py-3 dark:text-white forest:text-white love:text-loveWhite">{{totalPaiements | number_format(2, ',', ' ') }} €</p>
            <div class="flex justify-around pt-10">
                <div>
                    <h5 class="italic text-sm text-gray-600 py-1 dark:text-white forest:text-white love:text-loveWhite"> {{'this_month'|trans}}</h5>
                    <div class="flex items-center">
                        {% if totalPaiementsLastMonth > totalPaiementsThisMonth %}<i class="bi bi-caret-down-fill pe-1 text-red-600 text-xl"></i>{% elseif totalPaiementsLastMonth < totalPaiementsThisMonth %}<i class="bi bi-caret-up-fill pe-1 text-green-600 text-xl"></i>{% else %}<span class="pe-1 text-yellow-400 text-lg font-bold">&#8213;</span>{% endif %}
                        <p class="font-semibold text-xl py-1 dark:text-white forest:text-white love:text-loveWhite">{{totalPaiementsThisMonth | number_format(2, ',', ' ') }} €</p>
                    </div>
                </div>
                <div>
                    <h5 class="italic text-sm text-gray-600 py-1 dark:text-white forest:text-white love:text-loveWhite"> {{'today'|trans}}</h5>
                    <div class="flex items-center">
                        {% if totalPaiementsYesterday > totalPaiementsToday %}<i class="bi bi-caret-down-fill pe-1 text-red-600 text-xl"></i>{% elseif totalPaiementsYesterday < totalPaiementsToday %}<i class="bi bi-caret-up-fill pe-1 text-green-600 text-xl"></i>{% else %}<span class="pe-1 text-yellow-400 text-lg font-bold">&#8213;</span>
                        {% endif %}
                        <p class="font-semibold text-xl py-1 dark:text-white forest:text-white love:text-loveWhite">{{totalPaiementsToday | number_format(2, ',', ' ') }} €</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="border border-gray-300 h-72 w-full my-4 flex flex-col overflow-y-scroll">
            <div class="bg-darkBlue w-full h-12 flex items-center text-center justify-center shrink-0 sticky top-0 forest:bg-[#786759] love:bg-lovePink">
                <h3 class="text-white font-bold dark:text-white forest:text-white love:text-loveWhite"> {{'best_products'|trans}}</h3>
            </div>
            <table class="w-11/12 self-center my-2">
                <tbody class="">
                {% for product in bestSellers %}
                    <tr class="border-b">
                        <td class="w-2/4 text-left py-2 dark:text-white forest:text-white love:text-loveWhite">{{product.nom}}</td>
                        <td class="italic font-extralight w-1/4 text-right py-2 dark:text-white forest:text-white love:text-loveWhite"> {{'sold'|trans}}: {{product.total_sales}}</td>
                        <td class="italic w-1/4 text-right py-2 dark:text-white forest:text-white">{{(product.prix * product.total_sales)| number_format(2, ',', ' ')}} €</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="flex flex-col mx-6 gap-8 md:flex-row">
        <div class="border border-gray-300 w-full gap-8 h-72 my-4 md:gap-8 ">
            <div class="bg-darkBlue w-full h-12 flex items-center text-center justify-center forest:bg-[#786759] love:bg-lovePink">
                <h3 class="text-white font-bold dark:text-white forest:text-white love:text-loveWhite">{{'my_invoices'|trans}}</h3>
            </div>
            <div class="flex flex-col h-3/4 justify-around">
                <h4 class="text-md font-semibold py-3 dark:text-white forest:text-white love:text-loveWhite"> {{'unpaid'|trans}}</h4>
                <div class="flex text-center justify-around">
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{facturesAttente}}</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'invoices'|trans}}</p>
                    </div>
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{facturesAttenteMontant | number_format(2, ',', ' ')}} €</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'amount'|trans}}</p>
                    </div>
                </div>

                <hr class="w-1/2 mt-4 place-self-center">

                <h4 class="text-md font-semibold py-3 dark:text-white forest:text-white love:text-loveWhite">{{'late'|trans}}</h4>
                <div class="flex text-center justify-around">
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{facturesLate}}</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'invoices'|trans}}</p>
                    </div>
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{facturesLateMontant | number_format(2, ',', ' ')}} €</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'amount'|trans}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="border border-gray-300 h-72 w-full my-4">
            <div class="bg-darkBlue w-full h-12 flex items-center text-center justify-center forest:bg-[#786759] love:bg-lovePink love:text-loveWhite">
                <h3 class="text-white font-bold dark:text-white forest:text-white love:text-loveWhite">{{'my_estimates'|trans}}</h3>
            </div>
            <div class="flex flex-col h-3/4 justify-around">
                <h4 class="text-md font-semibold py-3 dark:text-white forest:text-white love:text-loveWhite">{{'in_progress'|trans}}</h4>
                <div class="flex text-center justify-around love:text-loveWhite">
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{devisAttente}}</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'estimates'|trans}}</p>
                    </div>
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{ devisAttenteMontant | number_format(2, ',', ' ')}} €</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite">{{'amount'|trans}}</p>
                    </div>
                </div>

                <hr class="w-1/2 mt-4 place-self-center">
                <h4 class="text-md font-semibold py-3 dark:text-white forest:text-white love:text-loveWhite"> {{'approved'|trans}}</h4>
                <div class="flex text-center justify-around">
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{devisApprouve}}</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite"> {{'estimates'|trans}}</p>
                    </div>
                    <div>
                        <p class="font-semibold text-lg dark:text-white forest:text-white love:text-loveWhite">{{devisApprouveMontant | number_format(2, ',', ' ')}} €</p>
                        <p class="dark:text-white forest:text-white love:text-loveWhite"> {{'amount'|trans}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="border border-gray-300 h-72 w-full my-4 flex flex-col overflow-y-scroll">
            <div class="bg-darkBlue w-full h-12 flex items-center text-center justify-center shrink-0 sticky top-0 forest:bg-[#786759] love:bg-lovePink">
                <h3 class="text-white font-bold dark:text-white forest:text-white love:text-loveWhite"> {{'my_recent_products'|trans}}</h3>
            </div>
            <table class="w-11/12 self-center my-2">
                <tbody>
                {% for produit in produits %}
                    <tr class="border-b">
                        <td class="w-3/5 text-sm text-left py-2 dark:text-white forest:text-white love:text-loveWhite">{{produit.nom}}</td>
                        <td class="italic text-sm font-extralight w-2/5 text-right py-2 dark:text-white forest:text-white love:text-loveWhite">{{ produit.CreatedAt|date('d-m-Y H:i') }}</td>
                    </tr>
                    {%  endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}